<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="OpenCase 内存耗尽的问题1.现象 使用3.5T  SSD 初始化opencas初始化，宿主机内存为120G，初始化成功后，运行一段时间出现内存全部消耗完。  2.opencas 版本信息123opencas version:19.9Linux kernel: 3.10.0-957.el7.x86_64CentOS Linux release 7.6.1810 (Core)  3.openc">
<meta property="og:type" content="article">
<meta property="og:title" content="OpenCAS 消耗过多内存问题">
<meta property="og:url" content="http://yoursite.com/2020/05/14/OpenCAS-%E6%B6%88%E8%80%97%E8%BF%87%E5%A4%9A%E5%86%85%E5%AD%98%E9%97%AE%E9%A2%98/index.html">
<meta property="og:site_name" content="perrynzhou">
<meta property="og:description" content="OpenCase 内存耗尽的问题1.现象 使用3.5T  SSD 初始化opencas初始化，宿主机内存为120G，初始化成功后，运行一段时间出现内存全部消耗完。  2.opencas 版本信息123opencas version:19.9Linux kernel: 3.10.0-957.el7.x86_64CentOS Linux release 7.6.1810 (Core)  3.openc">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-05-14T08:09:40.000Z">
<meta property="article:modified_time" content="2020-05-14T08:30:32.398Z">
<meta property="article:author" content="perrynzhou">
<meta property="article:tag" content="C">
<meta property="article:tag" content=" Go">
<meta property="article:tag" content=" 分布式存储">
<meta property="article:tag" content=" 对象存储">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/2020/05/14/OpenCAS-%E6%B6%88%E8%80%97%E8%BF%87%E5%A4%9A%E5%86%85%E5%AD%98%E9%97%AE%E9%A2%98/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>OpenCAS 消耗过多内存问题 | perrynzhou</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">perrynzhou</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">一个专注存储技术的疯子,https://github.com/perrynzhou</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/14/OpenCAS-%E6%B6%88%E8%80%97%E8%BF%87%E5%A4%9A%E5%86%85%E5%AD%98%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="perrynzhou">
      <meta itemprop="description" content="涉猎的主要编程语言为 C、Go，分布式存储和对象存储.https://github.com/perrynzhou。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="perrynzhou">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          OpenCAS 消耗过多内存问题
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-05-14 16:09:40 / Modified: 16:30:32" itemprop="dateCreated datePublished" datetime="2020-05-14T16:09:40+08:00">2020-05-14</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="OpenCase-内存耗尽的问题"><a href="#OpenCase-内存耗尽的问题" class="headerlink" title="OpenCase 内存耗尽的问题"></a>OpenCase 内存耗尽的问题</h2><h3 id="1-现象"><a href="#1-现象" class="headerlink" title="1.现象"></a>1.现象</h3><ul>
<li>使用3.5T  SSD 初始化opencas初始化，宿主机内存为120G，初始化成功后，运行一段时间出现内存全部消耗完。</li>
</ul>
<h3 id="2-opencas-版本信息"><a href="#2-opencas-版本信息" class="headerlink" title="2.opencas 版本信息"></a>2.opencas 版本信息</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">opencas version:19.9</span><br><span class="line">Linux kernel: 3.10.0-957.el7.x86_64</span><br><span class="line">CentOS Linux release 7.6.1810 (Core)</span><br></pre></td></tr></table></figure>

<h3 id="3-opencas-出问题时候日志"><a href="#3-opencas-出问题时候日志" class="headerlink" title="3.opencas 出问题时候日志"></a>3.opencas 出问题时候日志</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line">use command:  grep vmalloc &#x2F;proc&#x2F;vmallocinfo |grep cas_cache</span><br><span class="line">0xffffae2a4dffe000-0xffffae2a4e000000    8192 ocf_metadata_hash_ctrl_init+0x23&#x2F;0xe0 [cas_cache] pages&#x3D;1 vmalloc N0&#x3D;1</span><br><span class="line">0xffffae2a4ebb2000-0xffffae2a4ebb4000    8192 ocf_metadata_hash_ctrl_init+0x23&#x2F;0xe0 [cas_cache] pages&#x3D;1 vmalloc N0&#x3D;1</span><br><span class="line">0xffffae2a4ebb4000-0xffffae2a4ebb6000    8192 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;1 vmalloc N0&#x3D;1</span><br><span class="line">0xffffae2a4ebb6000-0xffffae2a4ebb8000    8192 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;1 vmalloc N0&#x3D;1</span><br><span class="line">0xffffae2a4ebb8000-0xffffae2a4ebc5000   53248 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;12 vmalloc N0&#x3D;12</span><br><span class="line">0xffffae2a4ebc5000-0xffffae2a4ebc7000    8192 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;1 vmalloc N0&#x3D;1</span><br><span class="line">0xffffae2a4ebc7000-0xffffae2a4ebd1000   40960 raw_dynamic_init+0x38&#x2F;0x90 [cas_cache] pages&#x3D;9 vmalloc N0&#x3D;9</span><br><span class="line">0xffffae2a4ebd1000-0xffffae2a4ebd3000    8192 _cache_mngt_cache_priv_init+0x2e&#x2F;0x60 [cas_cache] pages&#x3D;1 vmalloc N0&#x3D;1</span><br><span class="line">0xffffae2a4ebf1000-0xffffae2a4ebf3000    8192 _ocf_mngt_attach_cache_device+0x23&#x2F;0x1b0 [cas_cache] pages&#x3D;1 vmalloc N1&#x3D;1</span><br><span class="line">0xffffae2a4ebf3000-0xffffae2a4ebf5000    8192 ocf_volume_init+0x99&#x2F;0x100 [cas_cache] pages&#x3D;1 vmalloc N1&#x3D;1</span><br><span class="line">0xffffae2a4ebfc000-0xffffae2a4ebfe000    8192 ocf_freelist_init+0x25&#x2F;0x100 [cas_cache] pages&#x3D;1 vmalloc N1&#x3D;1</span><br><span class="line">0xffffae2a4ebfe000-0xffffae2a4ec00000    8192 ocf_freelist_init+0x64&#x2F;0x100 [cas_cache] pages&#x3D;1 vmalloc N1&#x3D;1</span><br><span class="line">0xffffae2a4edda000-0xffffae2a4edfb000  135168 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;32 vmalloc N0&#x3D;32</span><br><span class="line">0xffffae2a4edfb000-0xffffae2a4edfd000    8192 ocf_freelist_init+0x74&#x2F;0x100 [cas_cache] pages&#x3D;1 vmalloc N1&#x3D;1</span><br><span class="line">0xffffae2a4edfe000-0xffffae2a4ee00000    8192 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;1 vmalloc N0&#x3D;1</span><br><span class="line">0xffffae2a4ef01000-0xffffae2a4ef7b000  499712 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;121 vmalloc N0&#x3D;121</span><br><span class="line">0xffffae2a4ef7b000-0xffffae2a4ef87000   49152 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;11 vmalloc N1&#x3D;11</span><br><span class="line">0xffffae2a4ef87000-0xffffae2a4ef8f000   32768 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;7 vmalloc N1&#x3D;7</span><br><span class="line">0xffffae2a4ef8f000-0xffffae2a4ef9b000   49152 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;11 vmalloc N1&#x3D;11</span><br><span class="line">0xffffae2a4ef9b000-0xffffae2a4efab000   65536 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;15 vmalloc N1&#x3D;15</span><br><span class="line">0xffffae2a4efab000-0xffffae2a4efb9000   57344 ocf_metadata_concurrency_attached_init+0x3c&#x2F;0x190 [cas_cache] pages&#x3D;13 vmalloc N1&#x3D;13</span><br><span class="line">0xffffae2a4efbe000-0xffffae2a4efc0000    8192 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;1 vmalloc N0&#x3D;1</span><br><span class="line">0xffffae2a4efc0000-0xffffae2a4efe1000  135168 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;32 vmalloc N0&#x3D;32</span><br><span class="line">0xffffae2a4efe1000-0xffffae2a4efee000   53248 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;12 vmalloc N0&#x3D;12</span><br><span class="line">0xffffae2a4efee000-0xffffae2a4eff0000    8192 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;1 vmalloc N0&#x3D;1</span><br><span class="line">0xffffae2a4eff0000-0xffffae2a4effa000   40960 raw_dynamic_init+0x38&#x2F;0x90 [cas_cache] pages&#x3D;9 vmalloc N0&#x3D;9</span><br><span class="line">0xffffae2a4effa000-0xffffae2a4effc000    8192 _cache_mngt_cache_priv_init+0x2e&#x2F;0x60 [cas_cache] pages&#x3D;1 vmalloc N0&#x3D;1</span><br><span class="line">0xffffae2a4f101000-0xffffae2a4f17b000  499712 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;121 vmalloc N0&#x3D;121</span><br><span class="line">0xffffae2a4f17b000-0xffffae2a4f17d000    8192 _ocf_mngt_attach_cache_device+0x23&#x2F;0x1b0 [cas_cache] pages&#x3D;1 vmalloc N0&#x3D;1</span><br><span class="line">0xffffae2a4f17d000-0xffffae2a4f17f000    8192 ocf_volume_init+0x99&#x2F;0x100 [cas_cache] pages&#x3D;1 vmalloc N0&#x3D;1</span><br><span class="line">0xffffae2a4f17f000-0xffffae2a4f18b000   49152 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;11 vmalloc N0&#x3D;11</span><br><span class="line">0xffffae2a4f192000-0xffffae2a4f19a000   32768 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;7 vmalloc N0&#x3D;7</span><br><span class="line">0xffffae2a4f19a000-0xffffae2a4f1a6000   49152 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;11 vmalloc N0&#x3D;11</span><br><span class="line">0xffffae2a4f1a6000-0xffffae2a4f1b6000   65536 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;15 vmalloc N0&#x3D;15</span><br><span class="line">0xffffae2a4f1b6000-0xffffae2a4f1c4000   57344 ocf_metadata_concurrency_attached_init+0x3c&#x2F;0x190 [cas_cache] pages&#x3D;13 vmalloc N0&#x3D;13</span><br><span class="line">0xffffae2a4f1c4000-0xffffae2a4f1c6000    8192 ocf_freelist_init+0x25&#x2F;0x100 [cas_cache] pages&#x3D;1 vmalloc N0&#x3D;1</span><br><span class="line">0xffffae2a4f1c6000-0xffffae2a4f1c8000    8192 ocf_freelist_init+0x64&#x2F;0x100 [cas_cache] pages&#x3D;1 vmalloc N0&#x3D;1</span><br><span class="line">0xffffae2a4f1c8000-0xffffae2a4f1ca000    8192 ocf_freelist_init+0x74&#x2F;0x100 [cas_cache] pages&#x3D;1 vmalloc N0&#x3D;1</span><br><span class="line">0xffffae2a4f1ca000-0xffffae2a4f1d4000   40960 ocf_cache_line_concurrency_init+0x48&#x2F;0x190 [cas_cache] pages&#x3D;9 vmalloc N0&#x3D;9</span><br><span class="line">0xffffae2a4f1d4000-0xffffae2a4f1d9000   20480 _ocf_realloc_with_cp+0x158&#x2F;0x1b0 [cas_cache] pages&#x3D;4 vmalloc N0&#x3D;4</span><br><span class="line">0xffffae2a4f1d9000-0xffffae2a4f1de000   20480 _ocf_realloc_with_cp+0x158&#x2F;0x1b0 [cas_cache] pages&#x3D;4 vmalloc N1&#x3D;4</span><br><span class="line">0xffffae2a4f1df000-0xffffae2a4f1e1000    8192 ocf_promotion_init+0x2e&#x2F;0xc0 [cas_cache] pages&#x3D;1 vmalloc N0&#x3D;1</span><br><span class="line">0xffffae2a4f1e5000-0xffffae2a4f1ef000   40960 ocf_cache_line_concurrency_init+0x48&#x2F;0x190 [cas_cache] pages&#x3D;9 vmalloc N1&#x3D;9</span><br><span class="line">0xffffae2a4f1f5000-0xffffae2a4f1f7000    8192 ocf_promotion_init+0x2e&#x2F;0xc0 [cas_cache] pages&#x3D;1 vmalloc N1&#x3D;1</span><br><span class="line">0xffffae2a4f301000-0xffffae2a4f34b000  303104 ocf_metadata_concurrency_attached_init+0x57&#x2F;0x190 [cas_cache] pages&#x3D;73 vmalloc N0&#x3D;73</span><br><span class="line">0xffffae2a4f34b000-0xffffae2a4f395000  303104 ocf_metadata_concurrency_attached_init+0x57&#x2F;0x190 [cas_cache] pages&#x3D;73 vmalloc N1&#x3D;73</span><br><span class="line">0xffffae2a4f503000-0xffffae2a4f505000    8192 _raw_dynamic_get_item.isra.10+0xbc&#x2F;0x160 [cas_cache] pages&#x3D;1 vmalloc N0&#x3D;1</span><br><span class="line">0xffffae2a4f5fa000-0xffffae2a4f5fc000    8192 _raw_dynamic_get_item.isra.10+0xbc&#x2F;0x160 [cas_cache] pages&#x3D;1 vmalloc N1&#x3D;1</span><br><span class="line">0xffffae2a4fe90000-0xffffae2a4ff9a000 1089536 ocf_mngt_cache_start+0x1b0&#x2F;0x7a0 [cas_cache] pages&#x3D;265 vmalloc N0&#x3D;265</span><br><span class="line">0xffffae2a50b02000-0xffffae2a50c28000 1204224 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;293 vmalloc N0&#x3D;293</span><br><span class="line">0xffffae2a50c28000-0xffffae2a50d32000 1089536 ocf_mngt_cache_start+0x1b0&#x2F;0x7a0 [cas_cache] pages&#x3D;265 vmalloc N0&#x3D;265</span><br><span class="line">0xffffae2a50d32000-0xffffae2a50e58000 1204224 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;293 vmalloc N0&#x3D;293</span><br><span class="line">0xffffae2a50e58000-0xffffae2a52313000 21737472 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;5306 vmalloc vpages N0&#x3D;5306</span><br><span class="line">0xffffae2a52313000-0xffffae2a530e2000 14479360 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;3534 vmalloc vpages N0&#x3D;3534</span><br><span class="line">0xffffae2a530e2000-0xffffae2a5459d000 21737472 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;5306 vmalloc vpages N0&#x3D;5306</span><br><span class="line">0xffffae2a5459d000-0xffffae2a56311000 30883840 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;7539 vmalloc vpages N0&#x3D;7539</span><br><span class="line">0xffffae2a56311000-0xffffae2a564cc000 1814528 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;442 vmalloc N0&#x3D;442</span><br><span class="line">0xffffae2a564cc000-0xffffae2a57cf6000 25337856 ocf_metadata_concurrency_attached_init+0x3c&#x2F;0x190 [cas_cache] pages&#x3D;6185 vmalloc vpages N0&#x3D;6185</span><br><span class="line">0xffffae2a57cf6000-0xffffae2a58cf8000 16785408 ocf_cache_line_concurrency_init+0x48&#x2F;0x190 [cas_cache] pages&#x3D;4097 vmalloc vpages N0&#x3D;4097</span><br><span class="line">0xffffae2a58cf8000-0xffffae2a593e0000 7241728 _ocf_realloc_with_cp+0x158&#x2F;0x1b0 [cas_cache] pages&#x3D;1767 vmalloc vpages N0&#x3D;1767</span><br><span class="line">0xffffae2a5c278000-0xffffae2a5d733000 21737472 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;5306 vmalloc vpages N1&#x3D;5306</span><br><span class="line">0xffffae2a5d733000-0xffffae2a5e502000 14479360 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;3534 vmalloc vpages N1&#x3D;3534</span><br><span class="line">0xffffae2a5e502000-0xffffae2a5f9bd000 21737472 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;5306 vmalloc vpages N1&#x3D;5306</span><br><span class="line">0xffffae2a5f9bd000-0xffffae2a5fb78000 1814528 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;442 vmalloc N1&#x3D;442</span><br><span class="line">0xffffae2a70001000-0xffffae2d073a0000 11127091200 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;2716574 vmalloc vpages N0&#x3D;2716574</span><br><span class="line">0xffffae2d073a0000-0xffffae2ec0f22000 7410819072 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;1809281 vmalloc vpages N0&#x3D;1809281</span><br><span class="line">0xffffae2ec0f22000-0xffffae31582c1000 11127091200 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;2716574 vmalloc vpages N0&#x3D;2716574</span><br><span class="line">0xffffae31582c1000-0xffffae3506818000 15809736704 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;3859798 vmalloc vpages N0&#x3D;3859798</span><br><span class="line">0xffffae3506818000-0xffffae353db8a000 926359552 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;226161 vmalloc vpages N0&#x3D;226161</span><br><span class="line">0xffffae353db8a000-0xffffae3842bac000 12968927232 ocf_metadata_concurrency_attached_init+0x3c&#x2F;0x190 [cas_cache] pages&#x3D;3166241 vmalloc vpages N0&#x3D;3166241</span><br><span class="line">0xffffae3842bac000-0xffffae384bcc2000 152133632 ocf_metadata_concurrency_attached_init+0x57&#x2F;0x190 [cas_cache] pages&#x3D;37141 vmalloc vpages N0&#x3D;37141</span><br><span class="line">0xffffae384bcc2000-0xffffae3928a84000 3705413632 _ocf_realloc_with_cp+0x158&#x2F;0x1b0 [cas_cache] pages&#x3D;904641 vmalloc vpages N0&#x3D;904641</span><br><span class="line">0xffffae3928a84000-0xffffae3bbfe23000 11127091200 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;2716574 vmalloc vpages N1&#x3D;2716574</span><br><span class="line">0xffffae3bbfe23000-0xffffae3d799a5000 7410819072 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;1809281 vmalloc vpages N1&#x3D;1809281</span><br><span class="line">0xffffae3d799a5000-0xffffae4010d44000 11127091200 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;2716574 vmalloc vpages N1&#x3D;2716574</span><br><span class="line">0xffffae4010d44000-0xffffae43bf29b000 15809736704 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;3859798 vmalloc vpages N1&#x3D;3859798</span><br><span class="line">0xffffae43bf29b000-0xffffae43c100f000 30883840 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;7539 vmalloc vpages N1&#x3D;7539</span><br><span class="line">0xffffae43c100f000-0xffffae43f8381000 926359552 _raw_ram_init+0x2d&#x2F;0x70 [cas_cache] pages&#x3D;226161 vmalloc vpages N1&#x3D;226161</span><br><span class="line">0xffffae43f8381000-0xffffae46fd3a3000 12968927232 ocf_metadata_concurrency_attached_init+0x3c&#x2F;0x190 [cas_cache] pages&#x3D;3166241 vmalloc vpages N1&#x3D;3166241</span><br><span class="line">0xffffae46fd3a3000-0xffffae46febcd000 25337856 ocf_metadata_concurrency_attached_init+0x3c&#x2F;0x190 [cas_cache] pages&#x3D;6185 vmalloc vpages N1&#x3D;6185</span><br><span class="line">0xffffae46febcd000-0xffffae4707ce3000 152133632 ocf_metadata_concurrency_attached_init+0x57&#x2F;0x190 [cas_cache] pages&#x3D;37141 vmalloc vpages N1&#x3D;37141</span><br><span class="line">0xffffae4707ce3000-0xffffae4708ce5000 16785408 ocf_cache_line_concurrency_init+0x48&#x2F;0x190 [cas_cache] pages&#x3D;4097 vmalloc vpages N1&#x3D;4097</span><br><span class="line">0xffffae4708ce5000-0xffffae47e5aa7000 3705413632 _ocf_realloc_with_cp+0x158&#x2F;0x1b0 [cas_cache] pages&#x3D;904641 vmalloc vpages N1&#x3D;904641</span><br><span class="line">0xffffae47e5aa7000-0xffffae47e618f000 7241728 _ocf_realloc_with_cp+0x158&#x2F;0x1b0 [cas_cache] pages&#x3D;1767 vmalloc vpages N1&#x3D;1767</span><br><span class="line">0xffffae47e6eb3000-0xffffae47e6eec000  233472 cleaning_policy_acp_initialize+0x3e&#x2F;0x330 [cas_cache] pages&#x3D;56 vmalloc N1&#x3D;56</span><br><span class="line">0xffffae47e6eec000-0xffffae47e6ef3000   28672 cleaning_policy_acp_add_core+0x7c&#x2F;0x160 [cas_cache] pages&#x3D;6 vmalloc N1&#x3D;6</span><br><span class="line">0xffffae47e712a000-0xffffae47e7163000  233472 cleaning_policy_acp_initialize+0x3e&#x2F;0x330 [cas_cache] pages&#x3D;56 vmalloc N1&#x3D;56</span><br><span class="line">0xffffae47e7163000-0xffffae47e7169000   24576 cleaning_policy_acp_add_core+0x7c&#x2F;0x160 [cas_cache] pages&#x3D;5 vmalloc N1&#x3D;5</span><br><span class="line">0xffffae47e7692000-0xffffae47e8238000 12214272 cleaning_policy_acp_add_core+0x7c&#x2F;0x160 [cas_cache] pages&#x3D;2981 vmalloc vpages N1&#x3D;2981</span><br><span class="line">0xffffae47e8238000-0xffffae47e8af5000 9162752 cleaning_policy_acp_add_core+0x7c&#x2F;0x160 [cas_cache] pages&#x3D;2236 vmalloc vpages N1&#x3D;2236</span><br><span class="line"></span><br><span class="line">use command grep vmalloc &#x2F;proc&#x2F;vmallocinfo |grep cas_cache | awk &#39;&#123;total+&#x3D;$2&#125;; END &#123;print total&#125;&#39;</span><br><span class="line">126764556288 </span><br><span class="line">[root@szdpl1491 ~]# free -h</span><br><span class="line">              total        used        free      shared  buff&#x2F;cache   available</span><br><span class="line">Mem:           125G        123G        967M        5.1M        864M        194M</span><br><span class="line">Swap:           31G        7.9G         24G</span><br><span class="line"> </span><br><span class="line">the cas_cache use 118G,  I have  another sever with opencas for 1 month, the cas_cache use 59G</span><br></pre></td></tr></table></figure>
<h3 id="3-opencas-相关配置"><a href="#3-opencas-相关配置" class="headerlink" title="3.opencas 相关配置"></a>3.opencas 相关配置</h3><ul>
<li><p>cache mode: WT</p>
</li>
<li><p>cache config</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">casadm -L</span><br><span class="line"></span><br><span class="line">type    id   disk       status    write policy   device</span><br><span class="line">cache   1    &#x2F;dev&#x2F;sda   Running   wt             -</span><br><span class="line">└core   1    &#x2F;dev&#x2F;sdd   Active    -              &#x2F;dev&#x2F;cas1-1</span><br><span class="line">cache   2    &#x2F;dev&#x2F;sdb   Running   wt             -</span><br><span class="line">└core   1    &#x2F;dev&#x2F;sde   Active    -              &#x2F;dev&#x2F;cas2-1</span><br><span class="line">casadm -P -i 1</span><br><span class="line"></span><br><span class="line">Cache Id                  1</span><br><span class="line">Cache Size                926351414 [4KiB Blocks] &#x2F; 3533.75 [GiB]</span><br><span class="line">Cache Device              &#x2F;dev&#x2F;sda</span><br><span class="line">Core Devices              1</span><br><span class="line">Inactive Core Devices     0</span><br><span class="line">Write Policy              wt</span><br><span class="line">Eviction Policy           lru</span><br><span class="line">Cleaning Policy           alru</span><br><span class="line">Promotion Policy          always</span><br><span class="line">Cache line size           4 [KiB]</span><br><span class="line">Metadata Memory Footprint 46.7 [GiB]</span><br><span class="line">Dirty for                 0 [s] &#x2F; Cache clean</span><br><span class="line">Metadata Mode             normal</span><br><span class="line">Status                    Running</span><br><span class="line"></span><br><span class="line">╔══════════════════╤═══════════╤══════╤═════════════╗</span><br><span class="line">║ Usage statistics │   Count   │  %   │   Units     ║</span><br><span class="line">╠══════════════════╪═══════════╪══════╪═════════════╣</span><br><span class="line">║ Occupancy        │ 500156640 │ 54.0 │ 4KiB blocks ║</span><br><span class="line">║ Free             │ 426194774 │ 46.0 │ 4KiB blocks ║</span><br><span class="line">║ Clean            │ 500156640 │ 54.0 │ 4KiB blocks ║</span><br><span class="line">║ Dirty            │         0 │  0.0 │ 4KiB blocks ║</span><br><span class="line">╚══════════════════╧═══════════╧══════╧═════════════╝</span><br><span class="line"></span><br><span class="line">╔══════════════════════╤════════════╤═══════╤══════════╗</span><br><span class="line">║ Request statistics   │   Count    │   %   │ Units    ║</span><br><span class="line">╠══════════════════════╪════════════╪═══════╪══════════╣</span><br><span class="line">║ Read hits            │ 2628479218 │  61.6 │ Requests ║</span><br><span class="line">║ Read partial misses  │          0 │   0.0 │ Requests ║</span><br><span class="line">║ Read full misses     │         64 │   0.0 │ Requests ║</span><br><span class="line">║ Read total           │ 2628479282 │  61.6 │ Requests ║</span><br><span class="line">╟──────────────────────┼────────────┼───────┼──────────╢</span><br><span class="line">║ Write hits           │ 1579075690 │  37.0 │ Requests ║</span><br><span class="line">║ Write partial misses │    4237509 │   0.1 │ Requests ║</span><br><span class="line">║ Write full misses    │   58309934 │   1.4 │ Requests ║</span><br><span class="line">║ Write total          │ 1641623133 │  38.4 │ Requests ║</span><br><span class="line">╟──────────────────────┼────────────┼───────┼──────────╢</span><br><span class="line">║ Pass-Through reads   │          0 │   0.0 │ Requests ║</span><br><span class="line">║ Pass-Through writes  │          0 │   0.0 │ Requests ║</span><br><span class="line">║ Serviced requests    │ 4270102415 │ 100.0 │ Requests ║</span><br><span class="line">╟──────────────────────┼────────────┼───────┼──────────╢</span><br><span class="line">║ Total requests       │ 4270102415 │ 100.0 │ Requests ║</span><br><span class="line">╚══════════════════════╧════════════╧═══════╧══════════╝</span><br><span class="line"></span><br><span class="line">╔══════════════════════════════════╤═════════════╤═══════╤═════════════╗</span><br><span class="line">║ Block statistics                 │    Count    │   %   │   Units     ║</span><br><span class="line">╠══════════════════════════════════╪═════════════╪═══════╪═════════════╣</span><br><span class="line">║ Reads from core(s)               │         356 │   0.0 │ 4KiB blocks ║</span><br><span class="line">║ Writes to core(s)                │  2954907028 │ 100.0 │ 4KiB blocks ║</span><br><span class="line">║ Total to&#x2F;from core(s)            │  2954907384 │ 100.0 │ 4KiB blocks ║</span><br><span class="line">╟──────────────────────────────────┼─────────────┼───────┼─────────────╢</span><br><span class="line">║ Reads from cache                 │           0 │   0.0 │ 4KiB blocks ║</span><br><span class="line">║ Writes to cache                  │           0 │   0.0 │ 4KiB blocks ║</span><br><span class="line">║ Total to&#x2F;from cache              │           0 │   0.0 │ 4KiB blocks ║</span><br><span class="line">╟──────────────────────────────────┼─────────────┼───────┼─────────────╢</span><br><span class="line">║ Reads from exported object(s)    │ 12708231250 │  81.1 │ 4KiB blocks ║</span><br><span class="line">║ Writes to exported object(s)     │  2954907028 │  18.9 │ 4KiB blocks ║</span><br><span class="line">║ Total to&#x2F;from exported object(s) │ 15663138278 │ 100.0 │ 4KiB blocks ║</span><br><span class="line">╚══════════════════════════════════╧═════════════╧═══════╧═════════════╝</span><br><span class="line"></span><br><span class="line">╔════════════════════╤═══════╤═════╤══════════╗</span><br><span class="line">║ Error statistics   │ Count │  %  │ Units    ║</span><br><span class="line">╠════════════════════╪═══════╪═════╪══════════╣</span><br><span class="line">║ Cache read errors  │     0 │ 0.0 │ Requests ║</span><br><span class="line">║ Cache write errors │     0 │ 0.0 │ Requests ║</span><br><span class="line">║ Cache total errors │     0 │ 0.0 │ Requests ║</span><br><span class="line">╟────────────────────┼───────┼─────┼──────────╢</span><br><span class="line">║ Core read errors   │     0 │ 0.0 │ Requests ║</span><br><span class="line">║ Core write errors  │     0 │ 0.0 │ Requests ║</span><br><span class="line">║ Core total errors  │     0 │ 0.0 │ Requests ║</span><br><span class="line">╟────────────────────┼───────┼─────┼──────────╢</span><br><span class="line">║ Total errors       │     0 │ 0.0 │ Requests ║</span><br><span class="line">╚════════════════════╧═══════╧═════╧══════════╝</span><br></pre></td></tr></table></figure>
</li>
<li><p>cache line size</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># dmesg |grep &quot;Cache line size&quot;</span><br><span class="line">2751 [ 1505.783016] cache1: Hash offset : 44427904 kiB</span><br><span class="line">2752 [ 1505.783017] cache1: Hash size : 904644 kiB</span><br><span class="line">2753 [ 1505.783018] cache1: Cache line size: 4 kiB</span><br><span class="line">2754 [ 1505.783019] cache1: Metadata capacity: 47803 MiB</span><br><span class="line">2755 [ 1521.649327] cache1: OCF metadata self-test PASSED</span><br><span class="line">2756 [ 1527.389763] Thread cas_clean_cache1 started</span><br><span class="line"></span><br><span class="line">2893 [ 1823.699193] cache2: Hash offset : 44427904 kiB</span><br><span class="line">2894 [ 1823.699194] cache2: Hash size : 904644 kiB</span><br><span class="line">2895 [ 1823.699195] cache2: Cache line size: 4 kiB</span><br><span class="line">2896 [ 1823.699197] cache2: Metadata capacity: 47803 MiB</span><br><span class="line">2897 [ 1839.660385] cache2: OCF metadata self-test PASSED</span><br><span class="line">2898 [ 1845.359600] Thread cas_clean_cache2 started</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="5-解决方法"><a href="#5-解决方法" class="headerlink" title="5.解决方法"></a>5.解决方法</h3><ul>
<li>opencas在初始化时候casadm 需要添加–cache-line-size  参数，默认是4k，针对宿主机器消耗内存的计算公式为 内存消耗 =  SSD_size / Cache_Line_size  * 70 byte</li>
<li>官方给的简要说明<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">It looks quite normal to me. You have two huge cache devices (2 x 3.5TB) and size of CAS metadata is proportional to number of cache lines. CAS allocates about 70 bytes of metadata per cache line, so in your case it is about 60GiB of metadata per single cache, giving ~120GiB in total. That matches pretty well with your numbers.</span><br><span class="line"></span><br><span class="line">You can decrease memory consumption by choosing bigger cache line size. You can select cache line size up to 64kiB, which would decrease memory usage by factor of 16.</span><br><span class="line"></span><br><span class="line">I&#39;d also recommend you, if it&#39;s possible, to switch to CAS v20.3.</span><br><span class="line">CAS v19.9 was tested only with basic set of tests, while v20.3 was thoroughly validated with extensive set of tests, thus it&#39;s much more stable than any previous version.</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="6-关于opencas-cache-line官方说明"><a href="#6-关于opencas-cache-line官方说明" class="headerlink" title="6.关于opencas cache line官方说明"></a>6.关于opencas cache line官方说明</h3><p><strong>Why does Open CAS Linux use some DRAM space?</strong></p>
<p>Open CAS Linux uses a portion of system memory for metadata, which tells us where data resides. The amount of memory needed is proportional to the size of the cache space. This is true for any caching software solution. However with Open CAS Linux this memory footprint can be decreased using a larger cache line size set by the parameter <em>–cache-line-size</em> which may be useful in high density servers with many large HDDs.</p>
<p><strong>Configuration Tool Details</strong></p>
<p>The Open CAS Linux product includes a user-level configuration tool that provides complete control of the caching software. The commands and parameters available with this tool are detailed in this chapter.</p>
<p>To access help from the CLI, type the <em>-H</em> or -<em>-help</em> parameter for details. You can also view the man page for this product by entering the following command:</p>
<blockquote>
<p># man casadm</p>
</blockquote>
<p><strong>Usage:</strong> casadm –start-cache –cache-device <DEVICE> [option…]</DEVICE></p>
<p><strong>Example:</strong></p>
<blockquote>
<p># casadm –start-cache –cache-device /dev/sdc</p>
</blockquote>
<p>or</p>
<blockquote>
<p># casadm -S -d /dev/sdc</p>
</blockquote>
<p><strong>Description:</strong> Prepares a block device to be used as device for caching other block devices. Typically the cache devices are SSDs or other NVM block devices or RAM disks. The process starts a framework for device mappings pertaining to a specific cache ID. The cache can be loaded with an old state when using the <em>-l</em> or <em>–load</em> parameter (previous cache metadata will not be marked as invalid) or with a new state as the default (previous cache metadata will be marked as invalid).</p>
<p><strong>Required Parameters:</strong></p>
<p><strong>[-d, –cache-device ] :</strong> Caching device to be used. This is an SSD or any NVM block device or RAM disk shown in the <em>/dev</em> directory. <device> needs to be the complete path describing the caching device to be used, for example /dev/sdc.</device></p>
<p><strong>Optional Parameters:</strong></p>
<p><strong>[-i, –cache-id ]:</strong> Cache ID to create; &lt;1 to 16384&gt;. The ID may be specified or by default the command will use the lowest available number first.</p>
<p><strong>[-l, –load]:</strong> Load existing cache metadata from caching device. If the cache device has been used previously and then disabled (like in a reboot) and it is determined that the data in the core device has not changed since the cache device was used, this option will allow continuing the use of the data in the cache device without the need to re-warm the cache with data.</p>
<ul>
<li><em>Caution:</em> You must ensure that the last shutdown followed the instructions in section <a href="https://open-cas.github.io/guide_running.html#stopping-cache-instances" target="_blank" rel="noopener"><strong>Stopping Cache Instances</strong></a>. If there was any change in the core data prior to enabling the cache, data would be not synced correctly and will be corrupted.</li>
</ul>
<p><strong>[-f, –force]:</strong> Forces creation of a cache even if a file system exists on the cache device. This is typically used for devices that have been previously utilized as a cache device.</p>
<ul>
<li><em>Caution:</em> This will delete the file system and any existing data on the cache device.</li>
</ul>
<p><strong>[-c, –cache-mode ]:</strong> Sets the cache mode for a cache instance the first time it is started or created. The mode can be one of the following:</p>
<p><em>wt:</em> (default mode) Turns write-through mode on. When using this parameter, the write-through feature is enabled which allows the acceleration of only read intensive operations.</p>
<p><em>wb:</em> Turns write-back mode on. When using this parameter, the write-back feature is enabled which allows the acceleration of both read and write intensive operations.</p>
<ul>
<li><em>Caution:</em> A failure of the cache device may lead to the loss of data that has not yet been flushed to the core device.</li>
</ul>
<p><em>wa:</em> Turns write-around mode on. When using this parameter, the write-around feature is enabled which allows the acceleration of reads only. All write locations that do not already exist in the cache (i.e. the locations have not be read yet or have been evicted), are written directly to the core drive bypassing the cache. If the location being written already exists in cache, then both the cache and the core drive will be updated.</p>
<p><em>pt:</em> Starts cache in pass-through mode. Caching is effectively disabled in this mode. This allows the user to associate all their desired core devices to be cached prior to actually enabling caching. Once the core devices are associated, the user would dynamically switch to their desired caching mode (see ‘-Q | –set-cache-mode’ for details).</p>
<p><em>wo:</em> Turns write-only mode on. When using this parameter, the write-only feature is enabled which allows the acceleration of write intensive operations primarily.</p>
<ul>
<li><em>Caution:</em> A failure of the cache device may lead to the loss of data that has not yet been flushed to the core device.</li>
</ul>
<p><strong>[-x, –cache-line-size ]:</strong> Set cache line size {4 (default), 8, 16, 32, 64}. The cache line size can only be set when starting the cache and cannot be changed after cache is started.</p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/05/05/lustre-2-13%E9%83%A8%E7%BD%B2/" rel="prev" title="lustre-2.13部署">
      <i class="fa fa-chevron-left"></i> lustre-2.13部署
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/05/26/glusterfs%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%8C%82%E8%BD%BDinit%E6%B5%81%E7%A8%8B/" rel="next" title="glusterfs客户端挂载init流程">
      glusterfs客户端挂载init流程 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#OpenCase-内存耗尽的问题"><span class="nav-number">1.</span> <span class="nav-text">OpenCase 内存耗尽的问题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-现象"><span class="nav-number">1.1.</span> <span class="nav-text">1.现象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-opencas-版本信息"><span class="nav-number">1.2.</span> <span class="nav-text">2.opencas 版本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-opencas-出问题时候日志"><span class="nav-number">1.3.</span> <span class="nav-text">3.opencas 出问题时候日志</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-opencas-相关配置"><span class="nav-number">1.4.</span> <span class="nav-text">3.opencas 相关配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-解决方法"><span class="nav-number">1.5.</span> <span class="nav-text">5.解决方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-关于opencas-cache-line官方说明"><span class="nav-number">1.6.</span> <span class="nav-text">6.关于opencas cache line官方说明</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">perrynzhou</p>
  <div class="site-description" itemprop="description">涉猎的主要编程语言为 C、Go，分布式存储和对象存储.https://github.com/perrynzhou。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">31</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">perrynzhou</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
